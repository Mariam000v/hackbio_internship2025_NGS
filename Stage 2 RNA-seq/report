
RNA-seq Project 2 â€“ Workflow Report

This document summarizes the workflow and main steps performed for the RNA-seq analysis of BD-II Microglia samples.

1. Project Setup

Created a dedicated project directory for Project 2:

mkdir project2

2. Data Download

Downloaded raw RNA-seq data (FASTQ files) using SRA Explorer and a bash script:

nano download_data.sh


Organized all raw FASTQ files into a single folder:

mkdir raw_data
mv *fastq.gz raw_data/

3. Quality Control (QC)

Created a folder for QC results:

mkdir qc_result


Performed quality control on all raw FASTQ files using FastQC:

fastqc raw_data/* -o qc_result


Verified QC outputs:

ls -lh qc_result
# Check number of HTML and ZIP reports
ls qc_result/*fastqc.html | wc -l
ls qc_result/*fastqc.zip | wc -l

4. MultiQC Summary

Generated an aggregated QC report using MultiQC:

mkdir multiqc
multiqc qc_result/ -o multiqc/


Reviewed the summary report in the multiqc/ folder.

5. Read Trimming

Created a folder for trimmed reads:

mkdir trim


Prepared trimming script (trimmer.sh) using fastp or equivalent.

Executed trimming:

cd raw_data
./trimmer.sh


Organized outputs:

mv raw_data/trimmed trim/
mv raw_data/fastp_report trim/


Generated MultiQC summary for trimmed reads:

multiqc trim/fastp_report/ -o multiqc_trim/

6. Mapping / Alignment

Prepared reference genome:

mkdir -p ref
cp ../project1/Homo_sapiens_assembly38.fasta* ref/


Built STAR genome index:

mkdir -p ref/star_index
STAR --runThreadN 8 \
     --runMode genomeGenerate \
     --genomeDir ref/star_index \
     --genomeFastaFiles ref/Homo_sapiens_assembly38.fasta


Aligned trimmed reads with STAR:

bash align_reads.sh


Verified BAM files:

samtools quickcheck alignment_star/*.bam && echo "All good!"

7. Transcript Quantification

Created folder for gene counts:

mkdir -p counts


Downloaded Gencode annotation:

wget https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_38/gencode.v38.annotation.gtf.gz -P counts/
gunzip counts/gencode.v38.annotation.gtf.gz


Counted gene expression using featureCounts:

featureCounts -T 8 -p \
    -a counts/gencode.v38.annotation.gtf \
    -o counts/gene_counts.txt \
    alignment_star/*.bam


Verified counts:

ls counts/
cat counts/gene_counts.txt.summary
less counts/gene_counts.txt

8. Differential Expression Analysis

Performed differential gene expression analysis using DESeq2 in R.

Workflow included:

Importing count matrix and sample metadata

Subsetting comparisons (e.g., SBD vs FBD)

Running DESeq2

Filtering DEGs (padj < 0.05 and |log2FoldChange| > 1)

Generating volcano plots and heatmaps

Annotating genes using biomaRt

9. Gene Ontology (GO) and Pathway Enrichment

Functional enrichment analysis performed using ShinyGO (http://bioinformatics.sdstate.edu/go/
):

Upload DEG lists (upregulated or downregulated genes, prepared as a simple gene symbol list)

Select organism: Homo sapiens

Explore enriched:

GO Biological Processes (BP)

GO Molecular Functions (MF)

GO Cellular Components (CC)

KEGG / Reactome pathways

Download visualizations and tables for reporting

Notes

Multiple comparisons were performed (SBD vs FBD, SBD vs SHC, FBD vs FHC).

Each comparison generated separate DEG files for upregulated and downregulated genes.

ShinyGO analyses were done separately for each list.

All scripts, intermediate files, and outputs are organized in respective folders for reproducibility.
