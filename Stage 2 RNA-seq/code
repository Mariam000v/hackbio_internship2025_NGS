
#RNA-seq Project – Workflow

#This document summarizes the main steps of the RNA-seq project (Project 2).

#1. Project setup
# Create project directory
mkdir project2

#2. Data download
# Download data using SRA Explorer via bash script
nano download_data.sh

# Move FASTQ files to a single folder
mkdir raw_data
mv *fastq.gz raw_data/

#3. Quality Control
# Create folder for QC results
mkdir qc_result

# Run FastQC on all raw FASTQ files
fastqc raw_data/* -o qc_result

# List QC results
ls -lh qc_result

# Check that 16 FASTQ reports were generated
ls qc_result/*fastqc.html | wc -l
ls qc_result/*fastqc.zip | wc -l

#4. MultiQC Summary
# Generate MultiQC report for QC results
mkdir multiqc
multiqc qc_result/ -o multiqc/

# List MultiQC output
ls multiqc/

#5. Trimming
# Create folder for trimmed reads
mkdir trim

# Create trimming script
nano trimmer.sh

# Run trimming script
cd raw_data
./trimmer.sh/

# Move trimmed reads and Fastp reports
mv raw_data/trimmed trim/
mv raw_data/fastp_report trim/

# Run MultiQC on trimming reports
multiqc trim/fastp_reports/ -o multiqc_trim/

#6. Mapping
# Mapping with STAR 
#get the reference genome
mkdir -p ref
cp ../project1/Homo_sapiens_assembly38.fasta* ref/
ls
#Build STAR genome index
mkdir -p ref/star_index

STAR \
  --runThreadN 8 \
  --runMode genomeGenerate \
  --genomeDir ref/star_index \
  --genomeFastaFiles ref/Homo_sapiens_assembly38.fasta

#Align trimmed reads
Bash align…….sh
ls -lh alignment_Star
ls -lh alignment_Logs
# Check the bam files quickly
samtools quickcheck alignment_star/*.bam && echo "All good!"

#Counting the abundance of the transcriptome
mkdir -p counts
# Download the annotation file
wget https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_38/gencode.v38.annotation.gtf.gz -P counts/
# Uncompress the file
gunzip counts/gencode.v38.annotation.gtf.gz
# Run featureCounts
featureCounts -T 8 -p \
    -a counts/gencode.v38.annotation.gtf \
    -o counts/gene_counts.txt \
    alignment_star/*.bam

#check
ls counts/
ls alignment_star
cat counts/gene_counts.txt.summary
less counts/gene_counts.txt


#7. Differential Expression Analysis
# Differential expression analysis (DESeq2)
#R script: hackbio proj2

8. Gene Ontology / Pathway Enrichment
# Functional enrichment analysis of DE genes
# Using ShinyGO: https://bioinformatics.sdstate.edu/go/
# Steps:
# 1. Upload upregulated_genes_annotated.csv or downregulated_genes_annotated.csv
# 2. Select organism: Homo sapiens
# 3. Explore enriched GO terms and pathways





